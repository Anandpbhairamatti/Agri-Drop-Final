<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Agridrop - Agricultural Delivery Platform</title>
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="search.css">
  </head>
  <body>
    <header>
      <nav class="navbar">
        <h1 class="logo">Agridrop</h1>
        <button class="hamburger" aria-label="Toggle navigation">
          &#9776;
        </button>
        <ul class="nav-links" id="navbar">
          <!-- Navigation links will be dynamically updated here -->
        </ul>
      </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero" id="home">
      <div class="hero-content">
        <h2>Welcome to Agridrop</h2>
        <p>
          Your one-stop platform for all agricultural needs - fertilizers and
          Tools access, bio-waste management.
        </p>
      </div>
    </section>

    <!-- SearchBar -->
    <!-- <div class="search-bar">
        <input type="text" placeholder="Search for products..." />
        <button>Search</button>
         Search product result -->
    <!-- <div class="product-result">
  
        </div>
      </div> -->

    <!-- SearchBar -->
    <div class="search-bar">
      <input
        type="text"
        id="search-input"
        placeholder="Search for products..."
      />
      <button onclick="searchProducts()">Search</button>
      <!-- Search product result -->
    </div>
    <div class="products-container"></div>
    <h4 id="categories-h4">Explore Our Popular Categories</h4>
    <div class="categories-list">
      <ul>
        <div>
          <li>
            <a href="Product/pest.html"
              ><img
                src="Assets/pesticidecover.jpg"
                alt="Pesticide"
              /><br />Pesticide & Fertilizers</a
            >
          </li>
        </div>
        <div>
          <li>
            <a href="Product/tools.html"
              ><img src="Assets/toolscv.jpg" alt="Tools" /><br />Tools</a
            >
          </li>
        </div>
        <div>
          <li>
            <a href="Product/biowaste.html"
              ><img
                src="Assets/biowastecover.jpg"
                alt="Biowaste"
              /><br />Biowaste</a
            >
          </li>
        </div>
      </ul>
    </div>

    <!-- Services Section -->
    <section class="services">
      <h3>Our Services</h3>
      <div class="service-list">
        <div class="service">
          <h4>Fertilizerss access</h4>
          <p>
            Get expert Pesticides and fertilizers to manage your crops
            efficiently.
          </p>
        </div>
        <div class="service">
          <h4>Tools</h4>
          <p>Tools for their farming</p>
        </div>
        <div class="service">
          <h4>Bio-waste management</h4>
          <p>Bio-waste of agriculture is beneficial for Bio-fuel production</p>
        </div>
      </div>
    </section>

    <!-- Footer Section -->
    <footer class="footer">
      <p>
        Contact us:
        <a href="mailto:support@agridrop.com">support@agridrop.com</a> | Follow
        us on: <a href="#">Facebook</a> | <a href="#">Twitter</a> |
        <a href="#">Instagram</a>`
      </p>
      <p>&copy; 2024 Agridrop. All rights reserved.</p>
    </footer>

    <!-- Content Sections (Same as before) -->

    <script src="script.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
      import {
        getDatabase,
        ref,
        get,
        child,
      } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js";

      const firebaseConfig = {
        apiKey: "AIzaSyBLCWmhmY1qc_szY7PkLHHooPPZSbTeXj4",
        authDomain: "agridrop-5ffa8.firebaseapp.com",
        databaseURL: "https://agridrop-5ffa8-default-rtdb.firebaseio.com",
        projectId: "agridrop-5ffa8",
        storageBucket: "agridrop-5ffa8.appspot.com",
        messagingSenderId: "447104623367",
        appId: "1:447104623367:web:4938333541fee115559ba2",
        measurementId: "G-Z66S9DVKZX",
      };

      const app = initializeApp(firebaseConfig);
      const database = getDatabase(app);

      async function searchProducts() {
        const query = document
          .getElementById("search-input")
          .value.toLowerCase();
        const productsContainer = document.querySelector(".products-container");
        productsContainer.innerHTML = "<p>Loading...</p>";

        const dbRef = ref(database, "products");
        const snapshot = await get(dbRef);

        if (snapshot.exists()) {
          const allProducts = snapshot.val();
          const results = [];

          // Loop through all categories and their products
          for (const category in allProducts) {
            for (const productId in allProducts[category]) {
              const product = allProducts[category][productId];

              // Check if product name contains the search query
              if (product.name.toLowerCase().includes(query)) {
                results.push({
                  ...product,
                  category,
                  productId,
                });
              }
            }
          }

          // Display search results
          productsContainer.innerHTML = "";
          if (results.length > 0) {
            results.forEach((product) => {
              const productCard = document.createElement("div");
              productCard.classList.add("product-card");

              productCard.innerHTML = `
              <img src="${product.image}" alt="${product.name}">
              <h3>${product.name}</h3>
              <p>Category: ${product.category}</p>
              <p>Price: Rs ${product.price}</p>
              <p>${product.description}</p>
          `;

              productsContainer.appendChild(productCard);
            });
          } else {
            productsContainer.innerHTML = "<p>No products found.</p>";
          }
        } else {
          productsContainer.innerHTML =
            "<p>No products available in the database.</p>";
        }
      }

      // Attach the function to the window object
      window.searchProducts = searchProducts;

      let userState = {
        isLoggedIn: localStorage.getItem("isLoggedIn") === "true", // Check login status from localStorage
        isSeller: localStorage.getItem("isSeller") === "true", // Check if the user is a seller
      };

      const navbar = document.getElementById("navbar");

      function updateNavbar() {
        let links = "";

        if (!userState.isLoggedIn) {
          // New user (not logged in)
          links = `
        <li><a href="#home">Home</a></li>
        <li><a href="signup.html">Sign Up</a></li>
        <li><a href="#contact">About Us</a></li>
      `;
        } else if (userState.isLoggedIn && !userState.isSeller) {
          // Logged-in user (not a seller)
          links = `
        <li><a href="#home">Home</a></li>
        <li><a href="#" onclick="logout()">Logout</a></li>
        <li><a href="Seller/seller.html">Become a Seller</a></li>
        <li><a href="#profile">Profile</a></li>
      `;
        } else if (userState.isLoggedIn && userState.isSeller) {
          // Seller user
          links = `
        <li><a href="#home">Home</a></li>
        <li><a href="#" onclick="logout()">Logout</a></li>
        <li><a href="Seller/addProduct.html">Sell a Product</a></li>
        <li><a href="#profile">Profile</a></li>
      `;
        }

        navbar.innerHTML = links;
      }

      function logout() {
        // Simulate logout functionality
        userState.isLoggedIn = false;
        userState.isSeller = false;

        // Update localStorage to reflect the logout
        localStorage.setItem("isLoggedIn", "false");
        localStorage.setItem("isSeller", "false");

        updateNavbar();
        alert("You have been logged out.");
      }

      // function registerSeller() {
      //   // Simulate seller registration process
      //   alert('Congratulations! You are now a seller.');
      //   userState.isSeller = true;
      //   updateNavbar();

      //   // Update localStorage to reflect the new status
      //   localStorage.setItem('isSeller', 'true');

      // }

      // Initialize the navbar on page load
      updateNavbar();
    </script>
  </body>
</html>
